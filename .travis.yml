language: node_js
node_js:
  - 14

install:
  - npm install
  - sh setup.sh
  - git clone https://github.com/emscripten-core/emsdk.git
  - cd emsdk
  - ./emsdk install latest
  - ./emsdk activate latest
  - cd ..
  - source ./emsdk/emsdk_env.sh
  - npm run build-release

script:
- |
  npm run test
  npm run test-browser
  cp package.json ./emscriptenbuild/examples && cp COPYING ./emscriptenbuild/examples && cp README.md ./emscriptenbuild/examples && cd ./emscriptenbuild/examples && npm run semantic-release

notifications:
  email:
    on_success: never
    on_failure: change
    if: branch = master